<?php
//$etag = md5_file(__FILE__);	
$fp = fopen(__FILE__, "r");
$fstat = fstat($fp);
$fstat['atime']='';
$etag = md5(serialize($fstat)); 
fclose($fp);
	
$last_modified_time = filemtime(__FILE__);
$last_modified = gmdate('D, d M Y H:i:s', $last_modified_time) . ' GMT';
// did the browser send an if-modified-since request?
if ( isset($_SERVER['HTTP_IF_NONE_MATCH']) || isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) ) 
{
  // parse header
  $if_modified_since = preg_replace('/;.*$/', '', $_SERVER['HTTP_IF_MODIFIED_SINCE']);

  if (
  	  $if_modified_since == $last_modified ||  
  	  (isset($_SERVER['HTTP_IF_NONE_MATCH']) && trim($_SERVER['HTTP_IF_NONE_MATCH']) == $etag )
   ) 
   {
    // the browser's cache is still up to date
    header('HTTP/1.0 304 Not Modified');
    header('Cache-Control: must-revalidate');
    exit;
 	}
}

if ( !( ( ini_get( 'zlib.output_compression' ) == 'On' || ini_get( 'zlib.output_compression_level' ) > 0 ) || ini_get( 'output_handler' ) == 'ob_gzhandler' )  && extension_loaded( 'zlib' ) )
{	
	ob_start( 'ob_gzhandler' );	
} 
header("Content-type: text/javascript");
header('Cache-Control: must-revalidate');
$offset = 3600 *24  * 7;
$expire_str = "Expires: " . gmdate("D, d M Y H:i:s", time() + $offset) . " GMT";
header($expire_str);
header('Last-Modified: ' . $last_modified);
header("Etag: $etag"); 
?>

var BROWSER={};var USERAGENT=navigator.userAgent.toLowerCase();BROWSER.ie=window.ActiveXObject&&USERAGENT.indexOf("msie")!=-1&&USERAGENT.substr(USERAGENT.indexOf("msie")+5,3);BROWSER.firefox=USERAGENT.indexOf("firefox")!=-1&&USERAGENT.substr(USERAGENT.indexOf("firefox")+8,3);BROWSER.chrome=window.MessageEvent&&!document.getBoxObjectFor&&USERAGENT.indexOf("chrome")!=-1&&USERAGENT.substr(USERAGENT.indexOf("chrome")+7,10);BROWSER.opera=window.opera&&opera.version();BROWSER.safari=window.openDatabase&&USERAGENT.indexOf("safari")!=-1&&USERAGENT.substr(USERAGENT.indexOf("safari")+7,8);BROWSER.other=!BROWSER.ie&&!BROWSER.firefox&&!BROWSER.chrome&&!BROWSER.opera&&!BROWSER.safari;BROWSER.firefox=BROWSER.chrome?1:BROWSER.firefox;function AC_GetArgs(b,d,f){var a=new Object();a.embedAttrs=new Object();a.params=new Object();a.objAttrs=new Object();for(var c=0;c<b.length;c=c+2){var e=b[c].toLowerCase();switch(e){case"classid":break;case"pluginspage":a.embedAttrs[b[c]]="http://www.macromedia.com/go/getflashplayer";break;case"src":a.embedAttrs[b[c]]=b[c+1];a.params.movie=b[c+1];break;case"codebase":a.objAttrs[b[c]]="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0";break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblclick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"id":a.objAttrs[b[c]]=b[c+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":a.embedAttrs[b[c]]=a.objAttrs[b[c]]=b[c+1];break;default:a.embedAttrs[b[c]]=a.params[b[c]]=b[c+1]}}a.objAttrs.classid=d;if(f){a.embedAttrs.type=f}return a}function AC_DetectFlashVer(b,j,c){var l=-1;if(navigator.plugins!=null&&navigator.plugins.length>0&&(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"])){var k=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var m=navigator.plugins["Shockwave Flash"+k].description;var d=m.split(" ");var f=d[2].split(".");var a=f[0];var n=f[1];var g=d[3];if(g==""){g=d[4]}if(g[0]=="d"){g=g.substring(1)}else{if(g[0]=="r"){g=g.substring(1);if(g.indexOf("d")>0){g=g.substring(0,g.indexOf("d"))}}}l=a+"."+n+"."+g}else{if(BROWSER.ie&&!BROWSER.opera){try{var h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");l=h.GetVariable("$version")}catch(i){}}}if(l==-1){return false}else{if(l!=0){if(BROWSER.ie&&!BROWSER.opera){tempArray=l.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=l.split(".")}var a=versionArray[0];var n=versionArray[1];var g=versionArray[2];return a>parseFloat(b)||(a==parseFloat(b))&&(n>parseFloat(j)||n==parseFloat(j)&&g>=parseFloat(c))}}}function AC_FL_RunContent(){var c="";if(AC_DetectFlashVer(9,0,124)){var a=AC_GetArgs(arguments,"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");if(BROWSER.ie&&!BROWSER.opera){c+="<object ";for(var b in a.objAttrs){c+=b+'="'+a.objAttrs[b]+'" '}c+=">";for(var b in a.params){c+='<param name="'+b+'" value="'+a.params[b]+'" /> '}c+="</object>"}else{c+="<embed ";for(var b in a.embedAttrs){c+=b+'="'+a.embedAttrs[b]+'" '}c+="></embed>"}}else{c='此内容需要 Adobe Flash Player 9.0.124 或更高版本<br /><a href="http://www.adobe.com/go/getflashplayer/" target="_blank"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="下载 Flash Player" /></a>'}return c};

<?php if(extension_loaded('zlib')) {ob_end_flush();} ?>